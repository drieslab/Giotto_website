<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visium CytAssist Human Lung Cancer â€¢ Giotto</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Visium CytAssist Human Lung Cancer">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2V1K0KPLJC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2V1K0KPLJC');
</script>
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Giotto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Get started

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Giotto Installation</a>
    </li>
    <li>
      <a href="../articles/ecosystem.html">Giotto Ecosystem</a>
    </li>
    <li>
      <a href="../articles/structure.html">Giotto Class Structure</a>
    </li>
    <li>
      <a href="../articles/general_workflow.html">General Giotto Workflow</a>
    </li>
    <li>
      <a href="../articles/core_functions.html">Giotto Core Functions</a>
    </li>
    <li>
      <a href="../articles/faqs.html">FAQs</a>
    </li>
    <li>
      <a href="../articles/github_issues.html">How to report a bug</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Seq-Scope</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/seqscope_mouse_liver.html">Mouse liver</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Visium</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/visium_mouse_kidney.html">Visium Mouse Kidney</a>
        </li>
        <li>
          <a href="../articles/visium_mouse_brain.html">Visium Mouse Brain</a>
        </li>
        <li>
          <a href="../articles/visium_prostate_integration.html">Visium Prostate Integration</a>
        </li>
        <li>
          <a href="../articles/visium_cytassist_lungcancer.html">CytAssist Human Lung Cancer</a>
        </li>
        <li>
          <a href="../articles/visium_cytassist_human_glioblastoma.html">CytAssist Multi-omics Human Glioblastoma</a>
        </li>
        <li>
          <a href="../articles/VisiumHD_Human_Colorectal_Cancer.html">VisiumHD Human Colorectal Cancer</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Slide-seq</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/slideseq_mouse_brain.html">Slide-seq Mouse brain</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Spatial Genomics</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/spatial_genomics_mouse_kidney.html">Mouse Kidney</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">DBiT-Seq</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/mouse_embryo_dbitseq.html">Multi-omics Mouse Embryo DBiT-Seq</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Spatial CITE-Seq</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/spatial_citeseq_human_skin.html">Multi-omics Spatial CITE-Seq Human skin</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Xenium</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/xenium_breast_cancer.html">Xenium Human breast cancer</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Nanostring CosMx</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/nanostring_cosmx_lung_cancer.html">Nanostring CosMx Subcellular Lung Cancer</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">MERFISH</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/merfish_mouse_hypothalamic.html">MERFISH Mouse Hypothalamic Preoptic Region</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Vizgen</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/vizgen_mouse_brain.html">Vizgen Mouse Brain Receptor Map</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Open-ST</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/openst_mouse_hippocampus.html">Open-ST Mouse Hippocampus</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">seqFISH</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/mini_seqfish.html">mini seqFISH</a>
        </li>
        <li>
          <a href="../articles/seqfish_cortex.html">SeqFish+ Mouse Cortex Example</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">osmFISH</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/osmfish_mouse_ss_cortex.html">osmFISH Mouse SS Cortex</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Resolve Bioscience</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/resolve_biosciences.html">Resolve Bioscience Breast Cancer Subcellular</a>
        </li>
        <li>
          <a href="../articles/resolve_biosciences_human_lung.html">Resolve Bioscience Human lung</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">CODEX</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/codex_mouse_spleen.html">Codex Mouse Spleen</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Single Cell RNA Sequencing</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/singlecell_prostate_standard.html">Prostate</a>
        </li>
        <li>
          <a href="../articles/singlecell_prostate_integration.html">Prostate Integration</a>
        </li>
        <li>
          <a href="../articles/singlecell_lung_adenocarcinoma.html">Human Lung Adenocarcinoma</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Giotto Object</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/object_creation.html">Object creation</a>
        </li>
        <li>
          <a href="../articles/create_simulated_object.html">Create a simulated dataset object</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Giotto Configuration</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/configuration.html">Giotto Configuration</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Data Processing</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/process_giotto.html">Process Giotto convenience function</a>
        </li>
        <li>
          <a href="../articles/dimension_reduction.html">Dimension reduction</a>
        </li>
        <li>
          <a href="../articles/networks.html">Spatial and feature networks</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Spatial manipulation</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/spatial_transformations.html">Spatial transformations</a>
        </li>
        <li>
          <a href="https://drieslab.github.io/GiottoClass/articles/spatial_geometries.html" class="external-link">Spatial geometries</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Image alignment</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/image_alignment.html">Image alignment</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Interactivity</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/interactive_selection.html">Interactive selection</a>
        </li>
        <li>
          <a href="../articles/interactive_giotto_vitessceR.html">Interactive visualization with vitessceR</a>
        </li>
        <li>
          <a href="../articles/interactive_selection_cosmx.html">Interactive region selection on large datasets</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Visualizations</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/visualizations.html">Visualizations</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Saving and Loading</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/saving_object.html">Saving a Giotto object</a>
        </li>
        <li>
          <a href="../articles/saving_plots.html">Saving plots</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Interoperability</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/interoperability_anndata.html">AnnData</a>
        </li>
        <li>
          <a href="../articles/bento.html">Integrate Bento Analysis</a>
        </li>
        <li>
          <a href="../articles/ontrac.html">Integrate ONTraC Analysis</a>
        </li>
        <li>
          <a href="../articles/interoperability_spatialexperiment.html">SpatialExperiment</a>
        </li>
        <li>
          <a href="../articles/interoperability_seurat.html">Seurat</a>
        </li>
        <li>
          <a href="../articles/interoperability_spatialdata.html">SpatialData</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Try Giotto in the Cloud</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/terra.html">Giotto on Terra.bio</a>
        </li>
        <li>
          <a href="../articles/nemo_slideseq.html">NeMO Slide-seq on Terra.bio</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Containers</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/docker.html">Docker</a>
        </li>
        <li>
          <a href="../articles/singularity.html">Singularity</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Scalability</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/dbMatrix.html">Using dbMatrix with Giotto</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Changes</a>
    </li>
    <li>
      <a href="../articles/presentations.html">Presentations</a>
    </li>
    <li>
      <a href="../articles/branches.html">Branches</a>
    </li>
  </ul>
</li>
<li>
  <a></a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/drieslab/Giotto/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Visium CytAssist Human Lung Cancer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/drieslab/Giotto/blob/suite/vignettes/visium_cytassist_lungcancer.Rmd" class="external-link"><code>vignettes/visium_cytassist_lungcancer.Rmd</code></a></small>
      <div class="hidden name"><code>visium_cytassist_lungcancer.Rmd</code></div>

    </div>

    
    
<div class="section level2" number="1">
<h2 number="1" id="dataset-explanation">
<span class="header-section-number">1</span> Dataset Explanation<a class="anchor" aria-label="anchor" href="#dataset-explanation"></a>
</h2>
<p>The human lung cancer (FFPE) dataset was obtained from 10x Genomics using their CytAssist Visium technology that has been recently developed to allow users to perform standard histology workflows on two standard glass slides before transferring the transcriptional probes on the two-area capture visium slide.</p>
<p>More information about this dataset can be found <a href="https://www.10xgenomics.com/resources/datasets/human-lung-cancer-ffpe-2-standard/" class="external-link">here</a>.</p>
<p><img src="images%2Fvisium_cytassist_lungcancer%2FCytAssist_Visium_workflow.png" width="90%"></p>
</div>
<div class="section level2" number="2">
<h2 number="2" id="start-giotto">
<span class="header-section-number">2</span> Start Giotto<a class="anchor" aria-label="anchor" href="#start-giotto"></a>
</h2>
<p>To run the current vignette you need to install the Giotto Suite branch.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># Ensure Giotto Suite and GiottoData packages are installed</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="st">"Giotto"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/installed.packages.html" class="external-link">installed.packages</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"drieslab/Giotto"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Ensure the Python environment for Giotto has been installed</span></span>
<span>  <span class="va">genv_exists</span> <span class="op">&lt;-</span> <span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/giotto_python.html" class="external-link">checkGiottoEnvironment</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">genv_exists</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># The following command need only be run once to install the Giotto environment.</span></span>
<span>  <span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/giotto_python.html" class="external-link">installGiottoEnvironment</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2" number="3">
<h2 number="3" id="create-a-giotto-object">
<span class="header-section-number">3</span> Create a Giotto object<a class="anchor" aria-label="anchor" href="#create-a-giotto-object"></a>
</h2>
<p>The minimum requirements are</p>
<ul>
<li>matrix with expression information (or path to)</li>
<li>x,y(,z) coordinates for cells or spots (or path to)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://drieslab.github.io/Giotto/" class="external-link">Giotto</a></span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Provide path to visium folder</span></span>
<span><span class="va">data_path</span> <span class="op">&lt;-</span> <span class="st">"/path/to/data/"</span></span>
<span>  </span>
<span><span class="co"># to automatically save figures in save_dir set save_plot to TRUE</span></span>
<span><span class="va">results_folder</span> <span class="op">&lt;-</span> <span class="st">"/path/to/results/"</span></span>
<span>  </span>
<span><span class="va">python_path</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  </span>
<span><span class="va">instructions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/giotto_instructions.html" class="external-link">createGiottoInstructions</a></span><span class="op">(</span>save_dir <span class="op">=</span> <span class="va">results_folder</span>, </span>
<span>                                         save_plot <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                         show_plot <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                         return_plot <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                         python_path <span class="op">=</span> <span class="va">python_path</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># Create Giotto object</span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createGiottoVisiumObject.html">createGiottoVisiumObject</a></span><span class="op">(</span>visium_dir <span class="op">=</span> <span class="va">data_path</span>,</span>
<span>                                              expr_data <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>                                              png_name <span class="op">=</span> <span class="st">"tissue_lowres_image.png"</span>,</span>
<span>                                              gene_column_index <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                                              instructions <span class="op">=</span> <span class="va">instructions</span><span class="op">)</span></span>
<span>  </span>
<span><span class="co"># check metadata</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/pDataDT.html" class="external-link">pDataDT</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check available image names</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/showGiottoImageNames.html" class="external-link">showGiottoImageNames</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span> <span class="co"># "image" is the default name</span></span>
<span></span>
<span><span class="co"># show aligned image</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>         cell_color <span class="op">=</span> <span class="st">"in_tissue"</span>, </span>
<span>         show_image <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>         point_alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F0-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<p>How to work with Giotto instructions that are part of your Giotto object:</p>
<ul>
<li>show the instructions associated with your Giotto object with <strong>showGiottoInstructions()</strong>
</li>
<li>change one or more instructions with <strong>changeGiottoInstructions()</strong>
</li>
<li>replace all instructions at once with <strong>replaceGiottoInstructions()</strong>
</li>
<li>read or get a specific Giotto instruction with <strong>readGiottoInstructions()</strong>
</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show instructions associated with giotto object (visium_lungcancer)</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/showGiottoInstructions.html" class="external-link">showGiottoInstructions</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2" number="4">
<h2 number="4" id="processing-steps">
<span class="header-section-number">4</span> Processing steps<a class="anchor" aria-label="anchor" href="#processing-steps"></a>
</h2>
<ul>
<li>filter genes and cells based on detection frequencies</li>
<li>normalize expression matrix (log transformation, scaling factor and/or z-scores)</li>
<li>add cell and gene statistics (optional)</li>
<li>adjust expression matrix for technical covariates or batches (optional). These results will be stored in the <em>custom</em> slot.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filterGiotto.html">filterGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                                  expression_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                                  feat_det_in_min_cells <span class="op">=</span> <span class="fl">50</span>,</span>
<span>                                  min_det_feats_per_cell <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                                  expression_values <span class="op">=</span> <span class="st">"raw"</span>,</span>
<span>                                  verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalizeGiotto.html">normalizeGiotto</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                                     scalefactor <span class="op">=</span> <span class="fl">6000</span>, </span>
<span>                                     verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addStatistics.html">addStatistics</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span><span class="op">)</span></span></code></pre></div>
<div class="section level3" number="4.1">
<h3 number="4.1" id="visualize-aligned-tissue-with-number-of-features-after-processing">
<span class="header-section-number">4.1</span> Visualize aligned tissue with number of features after processing<a class="anchor" aria-label="anchor" href="#visualize-aligned-tissue-with-number-of-features-after-processing"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot2D</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>           show_image <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>           point_alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F1-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot2D</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>           show_image <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>           point_alpha <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>           cell_color <span class="op">=</span> <span class="st">"nr_feats"</span>, </span>
<span>           color_as_factor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F2-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2" number="5">
<h2 number="5" id="dimension-reduction">
<span class="header-section-number">5</span> Dimension Reduction<a class="anchor" aria-label="anchor" href="#dimension-reduction"></a>
</h2>
<ul>
<li>identify highly variable features (HVF)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateHVF.html">calculateHVF</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>perform PCA</li>
<li>identify number of significant principal components (PCs)</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPCA.html">runPCA</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/screePlot.html">screePlot</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>          ncp <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F3-screePlot.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotPCA.html" class="external-link">plotPCA</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F4-PCA.png" width="50%" style="display: block; margin: auto;"></p>
<ul>
<li>run UMAP and/or t-SNE on PCs (or directly on matrix)</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>                             dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotUMAP.html" class="external-link">plotUMAP</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F5-UMAP.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runtSNE.html">runtSNE</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>                             dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotTSNE.html" class="external-link">plotTSNE</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F6-tSNE.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2" number="6">
<h2 number="6" id="clustering">
<span class="header-section-number">6</span> Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h2>
<ul>
<li>create a shared (default) nearest network in PCA space (or directly on matrix)</li>
<li>cluster on nearest network with Leiden or Louvain (k-means and hclust are alternatives)</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create shared nearest network (SNN) and perform leiden clustering</span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createNearestNetwork.html" class="external-link">createNearestNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                                          dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>                                          k <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doLeidenCluster.html">doLeidenCluster</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                                     spat_unit <span class="op">=</span> <span class="st">"cell"</span>, </span>
<span>                                     feat_type <span class="op">=</span> <span class="st">"rna"</span>, </span>
<span>                                     resolution <span class="op">=</span> <span class="fl">0.4</span>, </span>
<span>                                     n_iterations <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize UMAP cluster results</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotUMAP.html" class="external-link">plotUMAP</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>         cell_color <span class="op">=</span> <span class="st">"leiden_clus"</span>, </span>
<span>         show_NN_network <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>         point_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F7-UMAP.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize tSNE cluster results</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotTSNE.html" class="external-link">plotTSNE</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>         cell_color <span class="op">=</span> <span class="st">"leiden_clus"</span>, </span>
<span>         show_NN_network <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>         point_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F8-tSNE.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize expression and spatial results</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatDimPlot.html" class="external-link">spatDimPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>            cell_color <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>            dim_point_size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>            spat_point_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F9-spatDimPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatDimPlot.html" class="external-link">spatDimPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>            cell_color <span class="op">=</span> <span class="st">"nr_feats"</span>, </span>
<span>            color_as_factor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            dim_point_size <span class="op">=</span> <span class="fl">2</span>, </span>
<span>            dim_show_legend <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>            spat_show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            spat_point_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F10-spatDimPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2" number="7">
<h2 number="7" id="differential-expression">
<span class="header-section-number">7</span> Differential expression<a class="anchor" aria-label="anchor" href="#differential-expression"></a>
</h2>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cell type marker detection</span></span>
<span><span class="co"># Gini markers</span></span>
<span><span class="va">gini_markers_subclusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findMarkers_one_vs_all.html">findMarkers_one_vs_all</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                                                   method <span class="op">=</span> <span class="st">"gini"</span>,</span>
<span>                                                   expression_values <span class="op">=</span> <span class="st">"normalized"</span>,</span>
<span>                                                   cluster_column <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>                                                   min_featss <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                                   min_expr_gini_score <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                                   min_det_gini_score <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get top 2 genes per cluster and visualize with violin plot</span></span>
<span><span class="va">topgenes_gini</span> <span class="op">&lt;-</span> <span class="va">gini_markers_subclusters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="fl">2</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"cluster"</span><span class="op">]</span><span class="op">$</span><span class="va">feats</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/violinPlot.html" class="external-link">violinPlot</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>           feats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">topgenes_gini</span><span class="op">)</span>, </span>
<span>           cluster_column <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>           strip_text <span class="op">=</span> <span class="fl">8</span>, </span>
<span>           strip_position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F11-violinPlot.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># cluster heatmap</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotMetaDataHeatmap.html" class="external-link">plotMetaDataHeatmap</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>                    selected_feats <span class="op">=</span> <span class="va">topgenes_gini</span>,</span>
<span>                    metadata_cols <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>                    x_text_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                    y_text_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F12-plotMetaDataHeatmap.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># umap plots</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/dimFeatPlot2D.html" class="external-link">dimFeatPlot2D</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>              expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>              feats <span class="op">=</span> <span class="va">gini_markers_subclusters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="fl">1</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"cluster"</span><span class="op">]</span><span class="op">$</span><span class="va">feats</span>,</span>
<span>              cow_n_col <span class="op">=</span> <span class="fl">3</span>,</span>
<span>              point_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F13-dimFeatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cell type marker detection</span></span>
<span><span class="co"># Scran markers</span></span>
<span><span class="va">scran_markers_subclusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findMarkers_one_vs_all.html">findMarkers_one_vs_all</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                                                    method <span class="op">=</span> <span class="st">"scran"</span>,</span>
<span>                                                    expression_values <span class="op">=</span> <span class="st">"normalized"</span>,</span>
<span>                                                    cluster_column <span class="op">=</span> <span class="st">"leiden_clus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get top 2 genes per cluster and visualize with violin plot</span></span>
<span><span class="va">topgenes_scran</span> <span class="op">&lt;-</span> <span class="va">scran_markers_subclusters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="fl">2</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"cluster"</span><span class="op">]</span><span class="op">$</span><span class="va">feats</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/violinPlot.html" class="external-link">violinPlot</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>           feats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">topgenes_scran</span><span class="op">)</span>,</span>
<span>           cluster_column <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>           strip_text <span class="op">=</span> <span class="fl">10</span>, </span>
<span>           strip_position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F14-violinPlot.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># cluster heatmap</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotMetaDataHeatmap.html" class="external-link">plotMetaDataHeatmap</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>                    selected_feats <span class="op">=</span> <span class="va">topgenes_scran</span>,</span>
<span>                    metadata_cols <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>                    x_text_size <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                    y_text_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F15-plotMetaDataHeatmap.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># umap plots</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/dimFeatPlot2D.html" class="external-link">dimFeatPlot2D</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>              expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>              feats <span class="op">=</span> <span class="va">scran_markers_subclusters</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="fl">1</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"cluster"</span><span class="op">]</span><span class="op">$</span><span class="va">feats</span>,</span>
<span>              cow_n_col <span class="op">=</span> <span class="fl">3</span>, </span>
<span>              point_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F16-dimFeatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2" number="8">
<h2 number="8" id="cell-type-enrichment">
<span class="header-section-number">8</span> Cell Type Enrichment<a class="anchor" aria-label="anchor" href="#cell-type-enrichment"></a>
</h2>
<p>Visium spatial transcriptomics does not provide single-cell resolution, making cell type annotation a harder problem. Giotto provides several ways to calculate enrichment of specific cell-type signature gene lists:</p>
<ul>
<li>PAGE</li>
<li>hypergeometric test</li>
<li>Rank</li>
<li>DWLS</li>
</ul>
<p>Corresponded Single cell dataset can be generated from <a href="https://drieslab.github.io/Giotto/articles/singlecell_lung_adenocarcinoma.html" class="external-link">Single Cell Human Lung Adenocarcinoma</a> vignette. You can also download the Giotto object, or count matrix and metadata from <a href="https://drive.google.com/drive/folders/1lv3KYkJoTy4vzJxyRT0zhm6RALVO89M8" class="external-link">here</a></p>
<p>Load the single-cell object</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">giotto_SC</span> <span class="op">&lt;-</span> <span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/loadGiotto.html" class="external-link">loadGiotto</a></span><span class="op">(</span><span class="st">"sc_lung_carcinoma"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3" number="8.1">
<h3 number="8.1" id="page">
<span class="header-section-number">8.1</span> PAGE<a class="anchor" aria-label="anchor" href="#page"></a>
</h3>
<p>The cell-type specific signature gene list was obtained from a previous study focused on investigating the therapy-induced evolution of lung cancer revealed by single-cell RNA sequencing. More information about the paper and scRNA-seq dataset can be found <a href="https://doi.org/10.1016/j.cell.2020.07.017" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># umap plots</span></span>
<span><span class="co"># Create PAGE matrix</span></span>
<span><span class="co"># PAGE matrix should be a binary matrix with each row represent a gene marker and each column represent a cell type</span></span>
<span><span class="co"># There are several ways to create PAGE matrix</span></span>
<span><span class="co"># 1.1 create binary matrix of cell signature genes</span></span>
<span><span class="co"># small example #</span></span>
<span><span class="va">Tcells_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD2"</span>, <span class="st">"CD3D"</span>, <span class="st">"CD3E"</span>, <span class="st">"CD3G"</span><span class="op">)</span></span>
<span><span class="va">macrophage_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MARCO"</span>, <span class="st">"CSF1R"</span>, <span class="st">"CD68"</span>, <span class="st">"GLDN"</span>, </span>
<span>                        <span class="st">"APOE"</span>, <span class="st">"CCL3L1"</span>, <span class="st">"TREM2"</span>, <span class="st">"C1QB"</span>, </span>
<span>                        <span class="st">"NUPR1"</span>, <span class="st">"FOLR2"</span>, <span class="st">"RNASE1"</span>, <span class="st">"C1QA"</span><span class="op">)</span></span>
<span><span class="va">dendritic_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD1E"</span>, <span class="st">"CD1C"</span>, <span class="st">"FCER1A"</span>, <span class="st">"PKIB"</span>, <span class="st">"CYP2S1"</span>, <span class="st">"NDRG2"</span><span class="op">)</span></span>
<span><span class="va">mast_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CMA1"</span>, <span class="st">"TPSAB1"</span>, <span class="st">"TPSB2"</span><span class="op">)</span></span>
<span><span class="va">Bcell_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IGLL5"</span>, <span class="st">"MZB1"</span>, <span class="st">"JCHAIN"</span>, <span class="st">"DERL3"</span>, <span class="st">"SDC1"</span>, </span>
<span>                   <span class="st">"MS$A1"</span>, <span class="st">"BANK1"</span>, <span class="st">"PAX5"</span>, <span class="st">"CD79A"</span><span class="op">)</span></span>
<span><span class="va">Bcell_PB_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PRDM1"</span>, <span class="st">"XSP1"</span>, <span class="st">"IRF4"</span><span class="op">)</span></span>
<span><span class="va">Bcell_mem_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MS4A1"</span>, <span class="st">"IRF8"</span><span class="op">)</span></span>
<span><span class="va">housekeeping_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTB"</span>, <span class="st">"GAPDH"</span>, <span class="st">"MALAT1"</span><span class="op">)</span></span>
<span><span class="va">neutrophils_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FCGR3B"</span>, <span class="st">"ALPL"</span>, <span class="st">"CXCR1"</span>, <span class="st">"CXCR2"</span>, </span>
<span>                         <span class="st">"ADGRG3"</span>, <span class="st">"CMTM2"</span>, <span class="st">"PROK2"</span>, <span class="st">"MME"</span>, <span class="st">"MMP25"</span>, <span class="st">"TNFRSF10C"</span><span class="op">)</span></span>
<span><span class="va">pdcs_markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SLC32A1"</span>, <span class="st">"SHD"</span>, <span class="st">"LRRC26"</span>, <span class="st">"PACSIN1"</span>, </span>
<span>                  <span class="st">"LILRA4"</span>, <span class="st">"CLEC4C"</span>, <span class="st">"DNASE1L3"</span>, <span class="st">"SCT"</span>, <span class="st">"LAMP5"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">signature_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignMatrixPAGE.html">makeSignMatrixPAGE</a></span><span class="op">(</span></span>
<span>  sign_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T_Cells"</span>, <span class="st">"Macrophage"</span>, <span class="st">"Dendritic"</span>, <span class="st">"Mast"</span>, </span>
<span>                 <span class="st">"B_cell"</span>, <span class="st">"Bcell_PB"</span>, <span class="st">"Bcells_memory"</span>,</span>
<span>                 <span class="st">"Housekeeping"</span>, <span class="st">"Neutrophils"</span>, <span class="st">"pDCs"</span><span class="op">)</span>,</span>
<span>  sign_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Tcells_markers</span>,</span>
<span>                   <span class="va">macrophage_markers</span>,</span>
<span>                   <span class="va">dendritic_markers</span>,</span>
<span>                   <span class="va">mast_markers</span>,</span>
<span>                   <span class="va">Bcell_markers</span>,</span>
<span>                   <span class="va">Bcell_PB_markers</span>,</span>
<span>                   <span class="va">Bcell_mem_markers</span>,</span>
<span>                   <span class="va">housekeeping_markers</span>,</span>
<span>                   <span class="va">neutrophils_markers</span>,</span>
<span>                   <span class="va">pdcs_markers</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1.3 enrichment test with PAGE</span></span>
<span><span class="va">markers_scran</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findMarkers_one_vs_all.html">findMarkers_one_vs_all</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">giotto_SC</span>, </span>
<span>                                        method <span class="op">=</span> <span class="st">"scran"</span>,</span>
<span>                                       expression_values <span class="op">=</span> <span class="st">"normalized"</span>, </span>
<span>                                       cluster_column <span class="op">=</span> <span class="st">"leiden_clus"</span>, </span>
<span>                                       min_feats <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">topgenes_scran</span> <span class="op">&lt;-</span> <span class="va">markers_scran</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="fl">10</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"cluster"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">celltypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">markers_scran</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sign_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">celltypes</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">sign_list</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">topgenes_scran</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">topgenes_scran</span><span class="op">$</span><span class="va">cluster</span> <span class="op">==</span> <span class="va">celltypes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>,<span class="op">]</span><span class="op">$</span><span class="va">feats</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">PAGE_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/makeSignMatrixPAGE.html">makeSignMatrixPAGE</a></span><span class="op">(</span>sign_names <span class="op">=</span> <span class="va">celltypes</span>,</span>
<span>                                  sign_list <span class="op">=</span> <span class="va">sign_list</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  runSpatialEnrich() can also be used as a wrapper for all currently provided enrichment options</span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPAGEEnrich.html">runPAGEEnrich</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                                   sign_matrix <span class="op">=</span> <span class="va">signature_matrix</span>, </span>
<span>                                   min_overlap_genes <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1.4 heatmap of enrichment versus annotation (e.g. clustering result)</span></span>
<span><span class="va">cell_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/row-plus-colnames-generic.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">signature_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotMetaDataCellsHeatmap.html" class="external-link">plotMetaDataCellsHeatmap</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                         metadata_cols <span class="op">=</span> <span class="st">"leiden_clus"</span>,</span>
<span>                         value_cols <span class="op">=</span> <span class="va">cell_types</span>,</span>
<span>                         spat_enr_names <span class="op">=</span> <span class="st">"PAGE"</span>,</span>
<span>                         x_text_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                         y_text_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                         show_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F17_metaheatmap.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cell_types_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/row-plus-colnames-generic.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">signature_matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatCellPlot.html" class="external-link">spatCellPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>             spat_enr_names <span class="op">=</span> <span class="st">"PAGE"</span>,</span>
<span>             cell_annotation_values <span class="op">=</span> <span class="va">cell_types_subset</span>,</span>
<span>             cow_n_col <span class="op">=</span> <span class="fl">4</span>, </span>
<span>             coord_fix_ratio <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>             point_size <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F18_spatCellPlot.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatDimCellPlot.html" class="external-link">spatDimCellPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                spat_enr_names <span class="op">=</span> <span class="st">"PAGE"</span>,</span>
<span>                cell_annotation_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B_cell"</span>,<span class="st">"Macrophage"</span><span class="op">)</span>,</span>
<span>                cow_n_col <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                spat_point_size <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>                plot_alignment <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F19_spatDimCellPlot.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2" number="9">
<h2 number="9" id="spatial-grids">
<span class="header-section-number">9</span> Spatial Grids<a class="anchor" aria-label="anchor" href="#spatial-grids"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createSpatialGrid.html" class="external-link">createSpatialGrid</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                                       sdimx_stepsize <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                                       sdimy_stepsize <span class="op">=</span> <span class="fl">400</span>,</span>
<span>                                       minimum_padding <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>         cell_color <span class="op">=</span> <span class="st">"leiden_clus"</span>, </span>
<span>         point_size <span class="op">=</span> <span class="fl">2.5</span>, </span>
<span>         show_grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         grid_color <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>         spatial_grid_name <span class="op">=</span> <span class="st">"spatial_grid"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F20-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2" number="10">
<h2 number="10" id="spatial-network">
<span class="header-section-number">10</span> Spatial Network<a class="anchor" aria-label="anchor" href="#spatial-network"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Delaunay network: stats + creation</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotStatDelaunayNetwork.html" class="external-link">plotStatDelaunayNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                        maximum_distance <span class="op">=</span> <span class="fl">400</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F21-plotStatDelaunayNetwork.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createSpatialNetwork.html" class="external-link">createSpatialNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                                          minimum_k <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/showGiottoSpatNetworks.html" class="external-link">showGiottoSpatNetworks</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>         show_network <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         network_color <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>         spatial_network_name <span class="op">=</span> <span class="st">"Delaunay_network"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F22-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2" number="11">
<h2 number="11" id="spatial-genes">
<span class="header-section-number">11</span> Spatial Genes<a class="anchor" aria-label="anchor" href="#spatial-genes"></a>
</h2>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># kmeans binarization</span></span>
<span><span class="va">km_spatialfeats</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binSpect.html">binSpect</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatFeatPlot2D.html" class="external-link">spatFeatPlot2D</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>               expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>               feats <span class="op">=</span> <span class="va">km_spatialfeats</span><span class="op">$</span><span class="va">feats</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, </span>
<span>               cow_n_col <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               point_size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F23-spatFeatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## rank binarization</span></span>
<span><span class="va">ranktest</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/binSpect.html">binSpect</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>                     bin_method <span class="op">=</span> <span class="st">"rank"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatFeatPlot2D.html" class="external-link">spatFeatPlot2D</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>               expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>               feats <span class="op">=</span> <span class="va">ranktest</span><span class="op">$</span><span class="va">feats</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, </span>
<span>               cow_n_col <span class="op">=</span> <span class="fl">2</span>, </span>
<span>               point_size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F24-spatFeatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## spatially correlated genes ##</span></span>
<span><span class="va">my_spatial_genes</span> <span class="op">&lt;-</span> <span class="va">km_spatialfeats</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span><span class="op">$</span><span class="va">feats</span></span>
<span></span>
<span><span class="co"># 1. calculate gene spatial correlation and single-cell correlation</span></span>
<span><span class="co"># create spatial correlation object</span></span>
<span><span class="va">spat_cor_netw_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detectSpatialCorFeats.html">detectSpatialCorFeats</a></span><span class="op">(</span></span>
<span>  <span class="va">visium_lungcancer</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"network"</span>,</span>
<span>  spatial_network_name <span class="op">=</span> <span class="st">"Delaunay_network"</span>,</span>
<span>  subset_feats <span class="op">=</span> <span class="va">my_spatial_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. identify most similar spatially correlated genes for one gene</span></span>
<span><span class="va">top10_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showSpatialCorFeats.html">showSpatialCorFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                   feats <span class="op">=</span> <span class="st">"DNAI1"</span>, </span>
<span>                                   show_top_feats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatFeatPlot2D.html" class="external-link">spatFeatPlot2D</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>               expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>               feats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RSPH1"</span>, <span class="st">"C20orf85"</span>, <span class="st">"DNAAF1"</span>,<span class="st">"TEKT2"</span><span class="op">)</span>, </span>
<span>               point_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F25-spatFeatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatFeatPlot2D.html" class="external-link">spatFeatPlot2D</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>               expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>               feats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TEKT2"</span>, <span class="st">"CFAP157"</span>, <span class="st">"MAPK15"</span>, <span class="st">"MS4A8"</span>, <span class="st">"CDHR3"</span>, <span class="st">"C9orf24"</span><span class="op">)</span>, </span>
<span>               point_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F26-spatFeatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3. cluster correlated genes &amp; visualize</span></span>
<span><span class="va">spat_cor_netw_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clusterSpatialCorFeats.html">clusterSpatialCorFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                           name <span class="op">=</span> <span class="st">"spat_netw_clus"</span>, </span>
<span>                                           k <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/heatmSpatialCorFeats.html">heatmSpatialCorFeats</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>                     spatCorObject <span class="op">=</span> <span class="va">spat_cor_netw_DT</span>,</span>
<span>                     use_clus_name <span class="op">=</span> <span class="st">"spat_netw_clus"</span>,</span>
<span>                     save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">"27-heatmap_correlated_genes"</span>,</span>
<span>                                       save_format <span class="op">=</span> <span class="st">"pdf"</span>,</span>
<span>                                       base_height <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                       base_width <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                                       units <span class="op">=</span> <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>                     heatmap_legend_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<embed src="images/visium_cytassist_lungcancer/27-heatmap_correlated_genes.pdf" width="50%" style="display: block; margin: auto;" type="application/pdf"></embed><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 4. rank spatial correlated clusters and show genes for selected clusters</span></span>
<span><span class="va">netw_ranks</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rankSpatialCorGroups.html">rankSpatialCorGroups</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>                                   spatCorObject <span class="op">=</span> <span class="va">spat_cor_netw_DT</span>,</span>
<span>                                   use_clus_name <span class="op">=</span> <span class="st">"spat_netw_clus"</span>,</span>
<span>                                   save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>save_name <span class="op">=</span> <span class="st">"28-rank_correlated_groups"</span>,</span>
<span>                                                  base_height <span class="op">=</span> <span class="fl">3</span>, base_width <span class="op">=</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_netw_spat_cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showSpatialCorFeats.html">showSpatialCorFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                             use_clus_name <span class="op">=</span> <span class="st">"spat_netw_clus"</span>,</span>
<span>                                             selected_clusters <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                                             show_top_feats <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F28-rank_correlated_groups.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 5. create metagene enrichment score for clusters</span></span>
<span><span class="va">cluster_genes_DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/showSpatialCorFeats.html">showSpatialCorFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                        use_clus_name <span class="op">=</span> <span class="st">"spat_netw_clus"</span>, </span>
<span>                                        show_top_feats <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cluster_genes</span> <span class="op">&lt;-</span> <span class="va">cluster_genes_DT</span><span class="op">$</span><span class="va">clus</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">cluster_genes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">cluster_genes_DT</span><span class="op">$</span><span class="va">feat_ID</span></span>
<span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createMetafeats.html" class="external-link">createMetafeats</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>, </span>
<span>                                     feat_clusters <span class="op">=</span> <span class="va">cluster_genes</span>, </span>
<span>                                     name <span class="op">=</span> <span class="st">"cluster_metagene"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/showGiottoSpatEnrichments.html" class="external-link">showGiottoSpatEnrichments</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatCellPlot.html" class="external-link">spatCellPlot</a></span><span class="op">(</span><span class="va">visium_lungcancer</span>,</span>
<span>             spat_enr_names <span class="op">=</span> <span class="st">"cluster_metagene"</span>,</span>
<span>             cell_annotation_values <span class="op">=</span> <span class="va">netw_ranks</span><span class="op">$</span><span class="va">clusters</span>,</span>
<span>             point_size <span class="op">=</span> <span class="fl">1.5</span>, </span>
<span>             cow_n_col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F29-spatCellPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2" number="12">
<h2 number="12" id="hmrf-domains">
<span class="header-section-number">12</span> HMRF Domains<a class="anchor" aria-label="anchor" href="#hmrf-domains"></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># HMRF requires a fully connected network!</span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createSpatialNetwork.html" class="external-link">createSpatialNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>                                          minimum_k <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                                          name <span class="op">=</span> <span class="st">"Delaunay_full"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># spatial genes</span></span>
<span><span class="va">my_spatial_genes</span> <span class="op">&lt;-</span> <span class="va">km_spatialfeats</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span><span class="op">$</span><span class="va">feats</span></span>
<span></span>
<span><span class="co"># do HMRF with different betas</span></span>
<span><span class="va">hmrf_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">results_dir</span>, <span class="st">"HMRF_results"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">hmrf_folder</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">hmrf_folder</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># if Rscript is not found, you might have to create a symbolic link, e.g.</span></span>
<span><span class="co"># cd /usr/local/bin</span></span>
<span><span class="co"># sudo ln -s /Library/Frameworks/R.framework/Resources/Rscript Rscript</span></span>
<span><span class="va">HMRF_spatial_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doHMRF.html">doHMRF</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                             expression_values <span class="op">=</span> <span class="st">"scaled"</span>,</span>
<span>                             spatial_network_name <span class="op">=</span> <span class="st">"Delaunay_full"</span>,</span>
<span>                             spatial_genes <span class="op">=</span> <span class="va">my_spatial_genes</span>,</span>
<span>                             k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                             betas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                             output_folder <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">hmrf_folder</span>, <span class="st">"Spatial_genes/SG_topgenes_k5_scaled"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## alternative way to view HMRF results</span></span>
<span><span class="co"># results = writeHMRFresults(gobject = ST_test,</span></span>
<span><span class="co">#                            HMRFoutput = HMRF_spatial_genes,</span></span>
<span><span class="co">#                            k = 5, betas_to_view = seq(0, 25, by = 5))</span></span>
<span><span class="co"># ST_test = addCellMetadata(ST_test, new_metadata = results, by_column = T, column_cell_ID = "cell_ID")</span></span>
<span></span>
<span><span class="co">## add HMRF of interest to giotto object</span></span>
<span><span class="va">visium_lungcancer</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addHMRF.html">addHMRF</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>,</span>
<span>                             HMRFoutput <span class="op">=</span> <span class="va">HMRF_spatial_genes</span>,</span>
<span>                             k <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                             betas_to_add <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>,</span>
<span>                             hmrf_name <span class="op">=</span> <span class="st">"HMRF"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/showGiottoSpatEnrichments.html" class="external-link">showGiottoSpatEnrichments</a></span><span class="op">(</span><span class="va">visium_lungcancer</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## visualize</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>         cell_color <span class="op">=</span> <span class="st">"HMRF_k5_b.0"</span>, </span>
<span>         point_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F30-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatPlot.html" class="external-link">spatPlot</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">visium_lungcancer</span>, </span>
<span>         cell_color <span class="op">=</span> <span class="st">"HMRF_k5_b.10"</span>, </span>
<span>         point_size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="images%2Fvisium_cytassist_lungcancer%2F31-spatPlot2D.png" width="50%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true"></a>R version <span class="dv">4</span>.<span class="fl">4.0</span> (<span class="dv">2024-04-24</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true"></a>Platform<span class="op">:</span><span class="st"> </span>x86_<span class="dv">64</span><span class="op">-</span>apple<span class="op">-</span>darwin20</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true"></a>Running under<span class="op">:</span><span class="st"> </span>macOS Sonoma <span class="fl">14.5</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true"></a>Matrix products<span class="op">:</span><span class="st"> </span>default</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true"></a>BLAS<span class="op">:</span><span class="st">   </span><span class="er">/</span>System<span class="op">/</span>Library<span class="op">/</span>Frameworks<span class="op">/</span>Accelerate.framework<span class="op">/</span>Versions<span class="op">/</span>A<span class="op">/</span>Frameworks<span class="op">/</span>vecLib.framework<span class="op">/</span>Versions<span class="op">/</span>A<span class="op">/</span>libBLAS.dylib </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true"></a>LAPACK<span class="op">:</span><span class="st"> </span><span class="er">/</span>Library<span class="op">/</span>Frameworks<span class="op">/</span>R.framework<span class="op">/</span>Versions<span class="op">/</span><span class="fl">4.4</span><span class="op">-</span>x86_<span class="dv">64</span><span class="op">/</span>Resources<span class="op">/</span>lib<span class="op">/</span>libRlapack.dylib;  LAPACK version <span class="dv">3</span>.<span class="fl">12.0</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true"></a>locale<span class="op">:</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true"></a>[<span class="dv">1</span>] en_US.UTF<span class="dv">-8</span><span class="op">/</span>en_US.UTF<span class="dv">-8</span><span class="op">/</span>en_US.UTF<span class="dv">-8</span><span class="op">/</span>C<span class="op">/</span>en_US.UTF<span class="dv">-8</span><span class="op">/</span>en_US.UTF<span class="dv">-8</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true"></a>time zone<span class="op">:</span><span class="st"> </span>America<span class="op">/</span>New_York</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true"></a>tzcode source<span class="op">:</span><span class="st"> </span>internal</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true"></a>attached base packages<span class="op">:</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true"></a>[<span class="dv">1</span>] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true"></a></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true"></a>other attached packages<span class="op">:</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true"></a>[<span class="dv">1</span>] Giotto_<span class="dv">4</span>.<span class="fl">1.0</span>      GiottoClass_<span class="dv">0</span>.<span class="fl">3.4</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true"></a>loaded via a <span class="kw">namespace</span> (and not attached)<span class="op">:</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true"></a><span class="st">  </span>[<span class="dv">1</span>] colorRamp2_<span class="dv">0</span>.<span class="fl">1.0</span>            deldir_<span class="fl">2.0</span><span class="dv">-4</span>               </span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true"></a>  [<span class="dv">3</span>] rlang_<span class="dv">1</span>.<span class="fl">1.4</span>                 magrittr_<span class="dv">2</span>.<span class="fl">0.3</span>             </span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true"></a>  [<span class="dv">5</span>] clue_<span class="fl">0.3</span><span class="dv">-65</span>                 GetoptLong_<span class="dv">1</span>.<span class="fl">0.5</span>           </span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true"></a>  [<span class="dv">7</span>] GiottoUtils_<span class="dv">0</span>.<span class="fl">1.10</span>          matrixStats_<span class="dv">1</span>.<span class="fl">3.0</span>          </span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true"></a>  [<span class="dv">9</span>] compiler_<span class="dv">4</span>.<span class="fl">4.0</span>              DelayedMatrixStats_<span class="dv">1</span>.<span class="fl">26.0</span>  </span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true"></a> [<span class="dv">11</span>] systemfonts_<span class="dv">1</span>.<span class="fl">1.0</span>           png_<span class="fl">0.1</span><span class="dv">-8</span>                  </span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true"></a> [<span class="dv">13</span>] vctrs_<span class="dv">0</span>.<span class="fl">6.5</span>                 reshape2_<span class="dv">1</span>.<span class="fl">4.4</span>             </span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true"></a> [<span class="dv">15</span>] stringr_<span class="dv">1</span>.<span class="fl">5.1</span>               shape_<span class="dv">1</span>.<span class="dv">4</span>.<span class="fl">6.1</span>              </span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true"></a> [<span class="dv">17</span>] pkgconfig_<span class="dv">2</span>.<span class="fl">0.3</span>             SpatialExperiment_<span class="dv">1</span>.<span class="fl">14.0</span>   </span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true"></a> [<span class="dv">19</span>] crayon_<span class="dv">1</span>.<span class="fl">5.3</span>                fastmap_<span class="dv">1</span>.<span class="fl">2.0</span>              </span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true"></a> [<span class="dv">21</span>] backports_<span class="dv">1</span>.<span class="fl">5.0</span>             magick_<span class="dv">2</span>.<span class="fl">8.4</span>               </span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true"></a> [<span class="dv">23</span>] XVector_<span class="dv">0</span>.<span class="fl">44.0</span>              labeling_<span class="dv">0</span>.<span class="fl">4.3</span>             </span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true"></a> [<span class="dv">25</span>] scuttle_<span class="dv">1</span>.<span class="fl">14.0</span>              utf8_<span class="dv">1</span>.<span class="fl">2.4</span>                 </span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true"></a> [<span class="dv">27</span>] rmarkdown_<span class="fl">2.27</span>              UCSC.utils_<span class="dv">1</span>.<span class="fl">0.0</span>           </span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true"></a> [<span class="dv">29</span>] ragg_<span class="dv">1</span>.<span class="fl">3.2</span>                  purrr_<span class="dv">1</span>.<span class="fl">0.2</span>                </span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true"></a> [<span class="dv">31</span>] bluster_<span class="dv">1</span>.<span class="fl">14.0</span>              xfun_<span class="fl">0.46</span>                  </span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true"></a> [<span class="dv">33</span>] zlibbioc_<span class="dv">1</span>.<span class="fl">50.0</span>             beachmat_<span class="dv">2</span>.<span class="fl">20.0</span>            </span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true"></a> [<span class="dv">35</span>] GenomeInfoDb_<span class="dv">1</span>.<span class="fl">40.1</span>         jsonlite_<span class="dv">1</span>.<span class="fl">8.8</span>             </span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true"></a> [<span class="dv">37</span>] DelayedArray_<span class="dv">0</span>.<span class="fl">30.1</span>         BiocParallel_<span class="dv">1</span>.<span class="fl">38.0</span>        </span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true"></a> [<span class="dv">39</span>] terra_<span class="fl">1.7</span><span class="dv">-78</span>                cluster_<span class="dv">2</span>.<span class="fl">1.6</span>              </span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true"></a> [<span class="dv">41</span>] irlba_<span class="dv">2</span>.<span class="dv">3</span>.<span class="fl">5.1</span>               parallel_<span class="dv">4</span>.<span class="fl">4.0</span>             </span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true"></a> [<span class="dv">43</span>] R6_<span class="dv">2</span>.<span class="fl">5.1</span>                    stringi_<span class="dv">1</span>.<span class="fl">8.4</span>              </span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true"></a> [<span class="dv">45</span>] RColorBrewer_<span class="fl">1.1</span><span class="dv">-3</span>          limma_<span class="dv">3</span>.<span class="fl">60.4</span>               </span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true"></a> [<span class="dv">47</span>] reticulate_<span class="dv">1</span>.<span class="fl">38.0</span>           GenomicRanges_<span class="dv">1</span>.<span class="fl">56.1</span>       </span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true"></a> [<span class="dv">49</span>] scattermore_<span class="fl">1.2</span>             iterators_<span class="dv">1</span>.<span class="fl">0.14</span>           </span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true"></a> [<span class="dv">51</span>] Rcpp_<span class="dv">1</span>.<span class="fl">0.13</span>                 SummarizedExperiment_<span class="dv">1</span>.<span class="fl">34.0</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true"></a> [<span class="dv">53</span>] knitr_<span class="fl">1.48</span>                  IRanges_<span class="dv">2</span>.<span class="fl">38.1</span>             </span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true"></a> [<span class="dv">55</span>] Matrix_<span class="fl">1.7</span><span class="dv">-0</span>                igraph_<span class="dv">2</span>.<span class="fl">0.3</span>               </span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true"></a> [<span class="dv">57</span>] tidyselect_<span class="dv">1</span>.<span class="fl">2.1</span>            rstudioapi_<span class="dv">0</span>.<span class="fl">16.0</span>          </span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true"></a> [<span class="dv">59</span>] abind_<span class="fl">1.4</span><span class="dv">-5</span>                 yaml_<span class="dv">2</span>.<span class="fl">3.10</span>                </span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true"></a> [<span class="dv">61</span>] doParallel_<span class="dv">1</span>.<span class="fl">0.17</span>           codetools_<span class="fl">0.2</span><span class="dv">-20</span>           </span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true"></a> [<span class="dv">63</span>] lattice_<span class="fl">0.22</span><span class="dv">-6</span>              tibble_<span class="dv">3</span>.<span class="fl">2.1</span>               </span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true"></a> [<span class="dv">65</span>] plyr_<span class="dv">1</span>.<span class="fl">8.9</span>                  Biobase_<span class="dv">2</span>.<span class="fl">64.0</span>             </span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true"></a> [<span class="dv">67</span>] withr_<span class="dv">3</span>.<span class="fl">0.0</span>                 evaluate_<span class="dv">0</span>.<span class="fl">24.0</span>            </span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true"></a> [<span class="dv">69</span>] circlize_<span class="dv">0</span>.<span class="fl">4.16</span>             pillar_<span class="dv">1</span>.<span class="fl">9.0</span>               </span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true"></a> [<span class="dv">71</span>] MatrixGenerics_<span class="dv">1</span>.<span class="fl">16.0</span>       foreach_<span class="dv">1</span>.<span class="fl">5.2</span>              </span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true"></a> [<span class="dv">73</span>] checkmate_<span class="dv">2</span>.<span class="fl">3.2</span>             stats4_<span class="dv">4</span>.<span class="fl">4.0</span>               </span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true"></a> [<span class="dv">75</span>] plotly_<span class="dv">4</span>.<span class="fl">10.4</span>               generics_<span class="dv">0</span>.<span class="fl">1.3</span>             </span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true"></a> [<span class="dv">77</span>] dbscan_<span class="fl">1.2</span><span class="dv">-0</span>                sp_<span class="fl">2.1</span><span class="dv">-4</span>                   </span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true"></a> [<span class="dv">79</span>] S4Vectors_<span class="dv">0</span>.<span class="fl">42.1</span>            ggplot2_<span class="dv">3</span>.<span class="fl">5.1</span>              </span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true"></a> [<span class="dv">81</span>] sparseMatrixStats_<span class="dv">1</span>.<span class="fl">16.0</span>    munsell_<span class="dv">0</span>.<span class="fl">5.1</span>              </span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true"></a> [<span class="dv">83</span>] scales_<span class="dv">1</span>.<span class="fl">3.0</span>                gtools_<span class="dv">3</span>.<span class="fl">9.5</span>               </span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true"></a> [<span class="dv">85</span>] glue_<span class="dv">1</span>.<span class="fl">7.0</span>                  metapod_<span class="dv">1</span>.<span class="fl">12.0</span>             </span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true"></a> [<span class="dv">87</span>] lazyeval_<span class="dv">0</span>.<span class="fl">2.2</span>              tools_<span class="dv">4</span>.<span class="fl">4.0</span>                </span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true"></a> [<span class="dv">89</span>] GiottoVisuals_<span class="dv">0</span>.<span class="fl">2.4</span>         BiocNeighbors_<span class="dv">1</span>.<span class="fl">22.0</span>       </span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true"></a> [<span class="dv">91</span>] data.table_<span class="dv">1</span>.<span class="fl">15.4</span>           ScaledMatrix_<span class="dv">1</span>.<span class="fl">12.0</span>        </span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true"></a> [<span class="dv">93</span>] locfit_<span class="fl">1.5-9.10</span>             scran_<span class="dv">1</span>.<span class="fl">32.0</span>               </span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true"></a> [<span class="dv">95</span>] Cairo_<span class="fl">1.6</span><span class="dv">-2</span>                 cowplot_<span class="dv">1</span>.<span class="fl">1.3</span>              </span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true"></a> [<span class="dv">97</span>] grid_<span class="dv">4</span>.<span class="fl">4.0</span>                  tidyr_<span class="dv">1</span>.<span class="fl">3.1</span>                </span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true"></a> [<span class="dv">99</span>] edgeR_<span class="dv">4</span>.<span class="fl">2.1</span>                 colorspace_<span class="fl">2.1</span><span class="dv">-1</span>           </span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true"></a>[<span class="dv">101</span>] SingleCellExperiment_<span class="dv">1</span>.<span class="fl">26.0</span> GenomeInfoDbData_<span class="dv">1</span>.<span class="fl">2.12</span>    </span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true"></a>[<span class="dv">103</span>] BiocSingular_<span class="dv">1</span>.<span class="fl">20.0</span>         cli_<span class="dv">3</span>.<span class="fl">6.3</span>                  </span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true"></a>[<span class="dv">105</span>] rsvd_<span class="dv">1</span>.<span class="fl">0.5</span>                  textshaping_<span class="dv">0</span>.<span class="fl">4.0</span>          </span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true"></a>[<span class="dv">107</span>] fansi_<span class="dv">1</span>.<span class="fl">0.6</span>                 S4Arrays_<span class="dv">1</span>.<span class="fl">4.1</span>             </span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true"></a>[<span class="dv">109</span>] viridisLite_<span class="dv">0</span>.<span class="fl">4.2</span>           ComplexHeatmap_<span class="dv">2</span>.<span class="fl">20.0</span>      </span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true"></a>[<span class="dv">111</span>] dplyr_<span class="dv">1</span>.<span class="fl">1.4</span>                 gtable_<span class="dv">0</span>.<span class="fl">3.5</span>               </span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true"></a>[<span class="dv">113</span>] digest_<span class="dv">0</span>.<span class="fl">6.36</span>               progressr_<span class="dv">0</span>.<span class="fl">14.0</span>           </span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true"></a>[<span class="dv">115</span>] BiocGenerics_<span class="dv">0</span>.<span class="fl">50.0</span>         dqrng_<span class="dv">0</span>.<span class="fl">4.1</span>                </span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true"></a>[<span class="dv">117</span>] SparseArray_<span class="dv">1</span>.<span class="fl">4.8</span>           ggrepel_<span class="dv">0</span>.<span class="fl">9.5</span>              </span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true"></a>[<span class="dv">119</span>] farver_<span class="dv">2</span>.<span class="fl">1.2</span>                rjson_<span class="dv">0</span>.<span class="fl">2.21</span>               </span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true"></a>[<span class="dv">121</span>] htmlwidgets_<span class="dv">1</span>.<span class="fl">6.4</span>           htmltools_<span class="dv">0</span>.<span class="dv">5</span>.<span class="fl">8.1</span>          </span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true"></a>[<span class="dv">123</span>] lifecycle_<span class="dv">1</span>.<span class="fl">0.4</span>             httr_<span class="dv">1</span>.<span class="fl">4.7</span>                 </span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true"></a>[<span class="dv">125</span>] GlobalOptions_<span class="dv">0</span>.<span class="fl">1.2</span>         statmod_<span class="dv">1</span>.<span class="fl">5.0</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.drieslab.com" class="external-link">Ruben Dries</a>, Jiaji George Chen, <a href="https://josschavezf.github.io" class="external-link">Joselyn C. ChÃ¡vez-Fuentes</a>, <a href="https://labs.icahn.mssm.edu/yuanlab/" class="external-link">Guo-Cheng Yuan</a>, Matthew Oâ€™Brien, Edward Ruiz, Wen Wang, Natalie Del Rossi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
