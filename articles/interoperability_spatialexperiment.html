<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interoperability: SpatialExperiment • Giotto</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Interoperability: SpatialExperiment">
<meta property="og:description" content="Giotto">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Giotto</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Get started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Giotto Installation</a>
    </li>
    <li>
      <a href="../articles/ecosystem.html">Giotto Ecosystem</a>
    </li>
    <li>
      <a href="../articles/structure.html">Giotto Class Structure</a>
    </li>
    <li>
      <a href="../articles/faqs.html">FAQs</a>
    </li>
    <li>
      <a href="../articles/github_issues.html">How to report a bug</a>
    </li>
    <li>
      <a href="../articles/contributing.html">Contributing guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Seq-Scope</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/seqscope_mouse_liver.html">Mouse liver</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Visium</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/visium_mouse_kidney.html">Visium Mouse Kidney</a>
        </li>
        <li>
          <a href="../articles/visium_mouse_brain.html">Visium Mouse Brain</a>
        </li>
        <li>
          <a href="../articles/visium_prostate_integration.html">Visium Prostate Integration</a>
        </li>
        <li>
          <a href="../articles/visium_cytassist_lungcancer.html">CytAssist Human Lung Cancer</a>
        </li>
        <li>
          <a href="../articles/visium_cytassist_human_glioblastoma.html">CytAssist Multi-omics Human Glioblastoma</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Spatial Genomics</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/spatial_genomics_mouse_kidney.html">Mouse Kidney</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">DBiT-Seq</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/mouse_embryo_dbitseq.html">Multi-omics Mouse Embryo DBiT-Seq</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Spatial CITE-Seq</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/spatial_citeseq_human_skin.html">Multi-omics Spatial CITE-Seq Human skin</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Xenium</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/xenium_breast_cancer.html">Xenium Human breast cancer</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Nanostring CosMx</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/nanostring_cosmx_lung_cancer.html">Nanostring CosMx Subcellular Lung Cancer</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">MERFISH</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/merfish_mouse_hypothalamic.html">MERFISH Mouse Hypothalamic Preoptic Region</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Vizgen</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/vizgen_mouse_brain.html">Vizgen Mouse Brain Receptor Map</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">seqFISH</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/mini_seqfish.html">mini seqFISH</a>
        </li>
        <li>
          <a href="../articles/seqfish_cortex.html">SeqFish+ Mouse Cortex Example</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">osmFISH</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/osmfish_mouse_ss_cortex.html">osmFISH Mouse SS Cortex</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Resolve Bioscience</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/resolve_biosciences.html">Resolve Bioscience Breast Cancer Subcellular</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">CODEX</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/codex_mouse_spleen.html">Codex Mouse Spleen</a>
        </li>
      </ul>
</li>
    <li class="divider">
    </li>
<li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Single Cell RNA Sequencing</a>
      <ul class="dropdown-menu" role="menu">
<li>
          <a href="../articles/singlecell_prostate_standard.html">Prostate</a>
        </li>
        <li>
          <a href="../articles/singlecell_prostate_integration.html">Prostate Integration</a>
        </li>
        <li>
          <a href="../articles/singlecell_lung_adenocarcinoma.html">Human Lung Adenocarcinoma</a>
        </li>
      </ul>
</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/object_creation.html">Giotto Object Creation</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../articles/configuration.html">Giotto Configuration</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Spatial manipulation</li>
    <li>
      <a href="../articles/spatial_transformations.html">Spatial transformations</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="https://drieslab.github.io/GiottoClass/articles/spatial_geometries.html">Spatial geometries</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Image alignment</li>
    <li>
      <a href="../articles/image_alignment.html">Image alignment</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Interactive selection</li>
    <li>
      <a href="../articles/interactive_selection.html">Interactive selection</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Visualizations</li>
    <li>
      <a href="../articles/visualizations.html">Visualizations</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Saving and Loading</li>
    <li>
      <a href="../articles/saving_object.html">Saving a Giotto object</a>
    </li>
    <li>
      <a href="../articles/saving_plots.html">Saving plots</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Interoperability</li>
    <li>
      <a href="../articles/interoperability_anndata.html">AnnData</a>
    </li>
    <li>
      <a href="../articles/interoperability_spatialexperiment.html">SpatialExperiment</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Try Giotto in the Cloud</li>
    <li>
      <a href="../articles/terra.html">Terra.bio</a>
    </li>
    <li>
      <a href="../articles/docker.html">Docker</a>
    </li>
    <li>
      <a href="../articles/singularity.html">Singularity</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Changes</a>
    </li>
    <li>
      <a href="../articles/presentations.html">Presentations</a>
    </li>
    <li>
      <a href="../articles/branches.html">Branches</a>
    </li>
  </ul>
</li>
<li>
  <a></a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/drieslab/Giotto/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Interoperability: SpatialExperiment</h1>
                        <h4 data-toc-skip class="author">Iqra Amin,
Irzam Sarfraz</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/drieslab/Giotto/blob/HEAD/vignettes/interoperability_spatialexperiment.Rmd" class="external-link"><code>vignettes/interoperability_spatialexperiment.Rmd</code></a></small>
      <div class="hidden name"><code>interoperability_spatialexperiment.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Giotto allows seamless analysis of spatial transcriptomics data
provided through a range of functions and algorithms. At the same time,
it also allows effortless conversion to other object types, so the data
can be analyzed with other tools including packages from Bioconductor
that mostly use Experiment objects and their derivatives. In this
tutorial, we show how cross-conversion between Giotto and
SpatialExperiment objects can complement spatial transcriptomic
analyses.</p>
<p>In the first part of the tutorial, we load an example Giotto object,
convert it to SpatialExperiment object and use a multitude of packages
from Bioconductor to analyze it. In the second part, we use an example
SpatialExperiment object, convert it to Giotto and drive the analysis
with the toolkit.</p>
</div>
<div class="section level2">
<h2 id="giotto-object-to-spatialexperiment">1. Giotto object to SpatialExperiment<a class="anchor" aria-label="anchor" href="#giotto-object-to-spatialexperiment"></a>
</h2>
<p>In this part of the tutorial, we show the conversion of a an example
Giotto object to SpatialExperiment object and use several packages to
process it. Initially, we load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://drieslab.github.io/Giotto/">Giotto</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://drieslab.github.io/GiottoData/">GiottoData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="load-a-giotto-object">1.2 Load a Giotto Object<a class="anchor" aria-label="anchor" href="#load-a-giotto-object"></a>
</h3>
<p>First, we load a example dataset from the GiottoData package. For
this tutorial, we import a mini mouse brain dataset generated using the
visium protocol.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoData/reference/loadGiottoMini.html">loadGiottoMini</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"visium"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convert-to-a-spatialexperiment-obj">1.3 Convert to a SpatialExperiment obj<a class="anchor" aria-label="anchor" href="#convert-to-a-spatialexperiment-obj"></a>
</h3>
<p>We now convert this imported giotto object into a SpatialExperiment
object using the “giottoToSpatialExperiment” function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gspe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/giottoToSpatialExperiment.html">giottoToSpatialExperiment</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<p>For each spatial unit the converter function returns a separate
SpatialExperiment object. The output is a list of objects (one object
for each unit) therefore we select the first object and use it
downstream.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">gspe</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downstream-analysis-using-spatialexperiment-object">1.4 Downstream Analysis using SpatialExperiment object<a class="anchor" aria-label="anchor" href="#downstream-analysis-using-spatialexperiment-object"></a>
</h3>
<p>Now, we do some processing on the object including quality control,
normalization, feature selection and dimensionality reduction.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/ggspavis" class="external-link">ggspavis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="quality-control-metrics">1.4.1 Quality Control Metrics<a class="anchor" aria-label="anchor" href="#quality-control-metrics"></a>
</h4>
<p>Using the <em>scater</em> package from Bioconductor, we perform some
initial quality control analysis. We particularly look for mitochondrial
genes and compute some quality control metrics including total counts
and features per cell. We then visualize these metrics and select
thresholds to remove low quality cells.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://bioconductor.org/packages/scater/" class="external-link">scater</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># identify mitochondrial genes</span></span>
<span><span class="va">is_mito</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"(^MT-)|(^mt-)"</span>, <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/row-plus-colnames-generic.html">rownames</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">is_mito</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate per-spot QC metrics and store in colData</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/addPerCellQCMetrics.html" class="external-link">addPerCellQC</a></span><span class="op">(</span><span class="va">spe</span>, subsets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mito <span class="op">=</span> <span class="va">is_mito</span><span class="op">)</span>,assay.type <span class="op">=</span> <span class="st">"raw_rna_cell"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We plot a histogram of library size and select a threshold of 50 to
remove low quality cells.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># histogram of library sizes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">sum</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select QC threshold</span></span>
<span><span class="va">qc_lib_size</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">sum</span> <span class="op">&lt;</span> <span class="fl">50</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/0-histogram.png"></p>
<p>We select a threshold of 18 for number of features detected per cell
and remove the low quality cells.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># histogram of numbers of expressed genes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">detected</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/1-histogram.png"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select QC threshold for number of expressed genes</span></span>
<span><span class="va">qc_detected</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">detected</span> <span class="op">&lt;</span> <span class="fl">18</span></span>
<span></span>
<span><span class="co"># combined set of discarded spots</span></span>
<span><span class="va">discard</span> <span class="op">&lt;-</span> <span class="va">qc_lib_size</span> <span class="op">|</span> <span class="va">qc_detected</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">discard</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">discard</span> <span class="op">&lt;-</span> <span class="va">discard</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">spe</span><span class="op">[</span>, <span class="op">!</span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">discard</span><span class="op">]</span></span>
<span><span class="va">spe</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="normalization">1.4.2 Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h4>
<p>Now we calculate log-transformed normalized counts(logcounts) using
library size factors using the scran package from Bioconductor.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">scran</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate library size factors</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/librarySizeFactors.html" class="external-link">computeLibraryFactors</a></span><span class="op">(</span><span class="va">spe</span>, assay.type<span class="op">=</span><span class="st">"raw_rna_cell"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">sizeFactors</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/dge.html" class="external-link">sizeFactors</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/2-histogram.png"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate logcounts and store in object</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scuttle/man/logNormCounts.html" class="external-link">logNormCounts</a></span><span class="op">(</span><span class="va">spe</span>, assay.type<span class="op">=</span><span class="st">"raw_rna_cell"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check</span></span>
<span><span class="fu">assayNames</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="feature-selection">1.4.3 Feature selection<a class="anchor" aria-label="anchor" href="#feature-selection"></a>
</h4>
<p>To identify HVGs (highly variable genes), we use a mean-variance
method “modelGeneVar” from the scran package.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit mean-variance relationship</span></span>
<span><span class="va">dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scran/man/modelGeneVar.html" class="external-link">modelGeneVar</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize mean-variance relationship</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">dec</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">mean</span>, <span class="va">fit</span><span class="op">$</span><span class="va">var</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"mean of log-expression"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">"variance of log-expression"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="fu">trend</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"dodgerblue"</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/3-fit.png"></p>
</div>
<div class="section level4">
<h4 id="dimentionality-reduction-pca">1.4.4 Dimentionality Reduction (PCA)<a class="anchor" aria-label="anchor" href="#dimentionality-reduction-pca"></a>
</h4>
<p>Now we apply dimensionality reduction methods to visualize the data
and to generate inputs for further downstream analyses. For this
purpose, we use the runPCA method to compute the top principal
components and then finally plot the top two components.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># compute PCA</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPCA.html">runPCA</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDimNames</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot top 2 PCA dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggspavis/man/plotDimRed.html" class="external-link">plotDimRed</a></span><span class="op">(</span><span class="va">spe</span> , type <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/4-PCA.png"></p>
<p>To visualize the clusters, we use a non-linear method “UMAP”, perform
clustering and plot the cluster labels over on the UMAP.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu">scater</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/runUMAP.html" class="external-link">runUMAP</a></span><span class="op">(</span><span class="va">spe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/row-plus-colnames-generic.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SingleCellExperiment/man/reducedDims.html" class="external-link">reducedDim</a></span><span class="op">(</span><span class="va">spe</span>,<span class="st">"UMAP"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UMAP1"</span>,<span class="st">"UMAP2"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggspavis/man/plotDimRed.html" class="external-link">plotDimRed</a></span><span class="op">(</span><span class="va">spe</span>, type <span class="op">=</span> <span class="st">"UMAP"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/5-UMAP.png"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># graph-based clustering</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span></span>
<span><span class="va">gGraphsnn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scran/man/buildSNNGraph.html" class="external-link">buildSNNGraph</a></span><span class="op">(</span><span class="va">spe</span>, k <span class="op">=</span> <span class="va">k</span>, use.dimred <span class="op">=</span> <span class="st">"PCA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_walk</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/cluster_walktrap.html" class="external-link">cluster_walktrap</a></span><span class="op">(</span><span class="va">gGraphsnn</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clus</span> <span class="op">&lt;-</span> <span class="va">g_walk</span><span class="op">$</span><span class="va">membership</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">clus</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot clusters in UMAP reduced dimensions</span></span>
<span><span class="fu">colData</span><span class="op">(</span><span class="va">spe</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="va">clus</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ggspavis/man/plotDimRed.html" class="external-link">plotDimRed</a></span><span class="op">(</span><span class="va">spe</span>, </span>
<span>           type <span class="op">=</span> <span class="st">"UMAP"</span>,</span>
<span>           annotate <span class="op">=</span> <span class="st">"label"</span>, </span>
<span>           palette <span class="op">=</span> <span class="st">"libd_layer_colors"</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/6-UMAP.png"></p>
<p>We identify the marker genes in each cluster and visualize the top
genes in each cluster using a pheatmap</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># test for marker genes</span></span>
<span><span class="va">markers</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findMarkers.html">findMarkers</a></span><span class="op">(</span><span class="va">spe</span>, test <span class="op">=</span> <span class="st">"binom"</span>, direction <span class="op">=</span> <span class="st">"up"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot log-fold changes for one cluster over all other clusters</span></span>
<span><span class="co"># selecting cluster 1</span></span>
<span><span class="va">interesting</span> <span class="op">&lt;-</span> <span class="va">markers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">best_set</span> <span class="op">&lt;-</span> <span class="va">interesting</span><span class="op">[</span><span class="va">interesting</span><span class="op">$</span><span class="va">Top</span> <span class="op">&lt;=</span> <span class="fl">5</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">logFCs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/scran/man/getMarkerEffects.html" class="external-link">getMarkerEffects</a></span><span class="op">(</span><span class="va">best_set</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span><span class="va">logFCs</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span>, length.out <span class="op">=</span> <span class="fl">101</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/7-heatmap.png"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot log-transformed normalized expression of top genes for one cluster</span></span>
<span><span class="va">top_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/row-plus-colnames-generic.html">rownames</a></span><span class="op">(</span><span class="va">interesting</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/scater/man/plotExpression.html" class="external-link">plotExpression</a></span><span class="op">(</span><span class="va">spe</span>, </span>
<span>               x <span class="op">=</span> <span class="st">"label"</span>, </span>
<span>               features <span class="op">=</span> <span class="va">top_genes</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/8-expression.png"></p>
</div>
</div>
<div class="section level3">
<h3 id="spatialexperiment-to-giotto-object">2. SpatialExperiment to Giotto object<a class="anchor" aria-label="anchor" href="#spatialexperiment-to-giotto-object"></a>
</h3>
<p>In this section, we load a sample dataset in the form of a
SpatialExperiment object, convert it to Giotto and drive the downstream
analysis with the Giotto toolkit.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lmweber/STexampleData" class="external-link">STexampleData</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-a-sample-spatialexperiment-obj">2.1 Load a sample SpatialExperiment obj<a class="anchor" aria-label="anchor" href="#load-a-sample-spatialexperiment-obj"></a>
</h3>
<p>Loading sample SpatialExperiment Object as spe</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/STexampleData/man/STexampleData.html" class="external-link">Visium_humanDLPFC</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">spe</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convert-to-a-giotto-obj">2.2 Convert to a giotto obj<a class="anchor" aria-label="anchor" href="#convert-to-a-giotto-obj"></a>
</h3>
<p>Converting SpatialExperiment Object to giottoobj. The new
giottoobject is n_g.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#create giottoObject from spe</span></span>
<span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/spatialExperimentToGiotto.html">spatialExperimentToGiotto</a></span><span class="op">(</span><span class="va">spe</span>, </span>
<span>                                 python_path <span class="op">=</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/instructions-generic.html">instructions</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">python_path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="downstream-analysis-with-the-giotto-toolkit">2.3 Downstream analysis with the giotto toolkit<a class="anchor" aria-label="anchor" href="#downstream-analysis-with-the-giotto-toolkit"></a>
</h3>
<p>We filter the giottoobj and then run normalization on it.</p>
<div class="section level4">
<h4 id="high-efficiency-data-processing">2.3.1 High Efficiency Data Processing<a class="anchor" aria-label="anchor" href="#high-efficiency-data-processing"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/processGiotto.html">processGiotto</a></span><span class="op">(</span></span>
<span>    <span class="va">n_g</span>,</span>
<span>    filter_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>expression_threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                         feat_det_in_min_cells <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                         min_det_feats_per_cell <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    norm_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>norm_methods <span class="op">=</span> <span class="st">'standard'</span>,</span>
<span>                       scale_feats <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       scalefactor <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,</span>
<span>    stat_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>expression_values <span class="op">=</span> <span class="st">'normalized'</span><span class="op">)</span>,</span>
<span>    adjust_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>expression_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'normalized'</span><span class="op">)</span>,</span>
<span>                         covariate_columns <span class="op">=</span> <span class="st">'nr_feats'</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="dimension-reduction-and-pca">2.3.2 Dimension Reduction and PCA<a class="anchor" aria-label="anchor" href="#dimension-reduction-and-pca"></a>
</h4>
<p>We first find the highly variable features (HVF) and then use these
to compute the reduced dimensions using PCA.</p>
<p>Calculate HVF using the loess regression prediction model:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculateHVF.html">calculateHVF</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span>, </span>
<span>                    method <span class="op">=</span> <span class="st">'cov_loess'</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/9-HVF.png"></p>
<p>PCA can be run based on the highly variable genes. After PCA, a tSNE,
a UMAP, or both may be run. For this example, highly variable genes have
been identified using Loess Regression predictions.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Select genes highly variable genes that fit specified statistics</span></span>
<span><span class="co"># These are both found within feature metadata</span></span>
<span><span class="va">feature_metadata</span> <span class="op">=</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/getFeatureMetadata.html">getFeatureMetadata</a></span><span class="op">(</span><span class="va">n_g</span><span class="op">)</span><span class="op">[</span><span class="op">]</span></span>
<span></span>
<span><span class="va">featgenes</span> <span class="op">=</span> <span class="va">feature_metadata</span><span class="op">[</span><span class="va">hvf</span> <span class="op">==</span> <span class="st">'yes'</span> <span class="op">&amp;</span> <span class="va">perc_cells</span> <span class="op">&gt;</span> <span class="fl">4</span> <span class="op">&amp;</span> <span class="va">mean_expr_det</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">]</span><span class="op">$</span><span class="va">feat_ID</span></span>
<span></span>
<span><span class="co">## run PCA on expression values (default)</span></span>
<span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="../reference/runPCA.html">runPCA</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span>, </span>
<span>                      feats_to_use <span class="op">=</span> <span class="va">featgenes</span>, </span>
<span>                      scale_unit <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                      center <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotPCA.html">plotPCA</a></span><span class="op">(</span><span class="va">n_g</span>,</span>
<span>                save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/10-PCA.png"></p>
<p>Run a UMAP based on PCA dimension reduction and view pre-clustering
UMAP.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span><span class="va">n_g</span>, </span>
<span>                       dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotUMAP.html">plotUMAP</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span>,</span>
<span>                 save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/11-UMAP.png"></p>
</div>
<div class="section level4">
<h4 id="clustering">2.3.3 Clustering<a class="anchor" aria-label="anchor" href="#clustering"></a>
</h4>
<p>Cells may be clustered into distinct groups based on feature
expression. To cluster, the Giotto Object must contain data that has
undergone PCA dimension reduction, either tSNE or UMAP dimension
reduction, and have a neighbor network.</p>
<p>Create a shared nearest neighbor network (sNN), where k is the number
of k neighbors to use:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createNearestNetwork.html">createNearestNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span>, </span>
<span>                            type <span class="op">=</span> <span class="st">"sNN"</span>, </span>
<span>                            dimensions_to_use <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, </span>
<span>                            k <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<p>Cells can be clustered in Giotto using k-means, Leiden, or Louvain
clustering. These clustering algorithms return cluster information
within cell_metadata, which is named accordingly by default. The name
may be changed by providing the name argument, as shown in the code
chunk below.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## k-means clustering</span></span>
<span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/doKmeans.html">doKmeans</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span>, </span>
<span>                dim_reduction_to_use <span class="op">=</span> <span class="st">'pca'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Plot UMAP post-clustering to visualize kmeans</span></span>
<span><span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/plotUMAP.html">plotUMAP</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span>,</span>
<span>                 cell_color <span class="op">=</span> <span class="st">'kmeans'</span>,</span>
<span>                 show_NN_network <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                 point_size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                 save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/12-UMAP.png"></p>
</div>
<div class="section level4">
<h4 id="spatial-co-expression">2.3.4 Spatial co-expression<a class="anchor" aria-label="anchor" href="#spatial-co-expression"></a>
</h4>
<p>Using previously created spatial network to calculate spatially
variable genes using binSpect method.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu">Giotto</span><span class="fu">::</span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createSpatialDelaunayNetwork.html">createSpatialDelaunayNetwork</a></span><span class="op">(</span>gobject <span class="op">=</span> <span class="va">n_g</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/showGiottoSpatNetworks.html">showGiottoSpatNetworks</a></span><span class="op">(</span><span class="va">n_g</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ranktest</span> <span class="op">=</span> <span class="fu"><a href="../reference/binSpect.html">binSpect</a></span><span class="op">(</span><span class="va">n_g</span>, </span>
<span>                    bin_method <span class="op">=</span> <span class="st">'rank'</span>,</span>
<span>                    calc_hub <span class="op">=</span> <span class="cn">T</span>, </span>
<span>                    hub_min_int <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                    spatial_network_name <span class="op">=</span> <span class="st">'Delaunay_network'</span><span class="op">)</span></span></code></pre></div>
<p>Here we will subset on the top 300 spatial genes identified with
binSpect. We will also show how to identify the top spatially correlated
genes.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3.1 cluster the top 500 spatial genes into 20 clusters</span></span>
<span><span class="va">ext_spatial_genes</span> <span class="op">=</span> <span class="va">ranktest</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">300</span>,<span class="op">]</span><span class="op">$</span><span class="va">feats</span></span>
<span></span>
<span><span class="co"># here we use existing detectSpatialCorGenes function to calculate pairwise distances between genes (but set network_smoothing=0 to use default clustering)</span></span>
<span><span class="va">spat_cor_netw_DT</span> <span class="op">=</span> <span class="fu"><a href="../reference/detectSpatialCorFeats.html">detectSpatialCorFeats</a></span><span class="op">(</span><span class="va">n_g</span>,</span>
<span>                                         method <span class="op">=</span> <span class="st">'network'</span>,</span>
<span>                                         spatial_network_name <span class="op">=</span> <span class="st">'Delaunay_network'</span>,</span>
<span>                                         subset_feats <span class="op">=</span> <span class="va">ext_spatial_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3.2 identify most similar spatially correlated genes for one gene</span></span>
<span><span class="va">top10_genes</span> <span class="op">=</span> <span class="fu"><a href="../reference/showSpatialCorFeats.html">showSpatialCorFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                  feats <span class="op">=</span> <span class="st">'Dsp'</span>, </span>
<span>                                  show_top_feats <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p>Use the pheatmap to identify spatial co-expression modules and adjust
the number of clusters (k) accordingly.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3.3 identify potenial spatial co-expression</span></span>
<span><span class="va">spat_cor_netw_DT</span> <span class="op">=</span> <span class="fu"><a href="../reference/clusterSpatialCorFeats.html">clusterSpatialCorFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                          name <span class="op">=</span> <span class="st">'spat_netw_clus'</span>, </span>
<span>                                          k <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize clusters</span></span>
<span><span class="fu"><a href="../reference/heatmSpatialCorFeats.html">heatmSpatialCorFeats</a></span><span class="op">(</span></span>
<span>    <span class="va">n_g</span>,</span>
<span>    spatCorObject <span class="op">=</span> <span class="va">spat_cor_netw_DT</span>,</span>
<span>    use_clus_name <span class="op">=</span> <span class="st">'spat_netw_clus'</span>,</span>
<span>    heatmap_legend_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>    save_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    save_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>base_height <span class="op">=</span> <span class="fl">6</span>, base_width <span class="op">=</span> <span class="fl">8</span>, units <span class="op">=</span> <span class="st">'cm'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/13-heatmSpatialCorFeats.png"></p>
<p>genes from each co-expression module and then aggregate genes into
meta genes.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3.4 create metagenes / co-expression modules</span></span>
<span><span class="va">cluster_genes</span> <span class="op">=</span> <span class="fu"><a href="../reference/getBalancedSpatCoexpressionFeats.html">getBalancedSpatCoexpressionFeats</a></span><span class="op">(</span><span class="va">spat_cor_netw_DT</span>, </span>
<span>                                                 maximum <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://drieslab.github.io/GiottoClass/reference/createMetafeats.html">createMetafeats</a></span><span class="op">(</span><span class="va">n_g</span>, feat_clusters <span class="op">=</span> <span class="va">cluster_genes</span>, </span>
<span>                       name <span class="op">=</span> <span class="st">'cluster_metagene'</span><span class="op">)</span>                     </span>
<span>    </span>
<span><span class="fu"><a href="https://drieslab.github.io/GiottoVisuals/reference/spatCellPlot.html">spatCellPlot</a></span><span class="op">(</span><span class="va">n_g</span>,</span>
<span>             spat_enr_names <span class="op">=</span> <span class="st">'cluster_metagene'</span>,</span>
<span>             cell_annotation_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             point_size <span class="op">=</span> <span class="fl">1</span>, </span>
<span>             cow_n_col <span class="op">=</span> <span class="fl">3</span>,</span>
<span>             save_plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>   </span></code></pre></div>
<p><img src="images/interoperability_spatialexperiment/14-spatCellPlot2D.png"></p>
</div>
</div>
<div class="section level3">
<h3 id="session-info">3. Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h3>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>R version <span class="dv">4</span>.<span class="fl">3.2</span> (<span class="dv">2023-10-31</span>)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>Platform<span class="sc">:</span> x86_64<span class="sc">-</span>apple<span class="sc">-</span><span class="fu">darwin20</span> (<span class="dv">64</span><span class="sc">-</span>bit)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>Running under<span class="sc">:</span> macOS Sonoma <span class="dv">14</span>.<span class="fl">3.1</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>Matrix products<span class="sc">:</span> default</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a>BLAS<span class="sc">:</span>   <span class="er">/</span>System<span class="sc">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>Accelerate.framework<span class="sc">/</span>Versions<span class="sc">/</span>A<span class="sc">/</span>Frameworks<span class="sc">/</span>vecLib.framework<span class="sc">/</span>Versions<span class="sc">/</span>A<span class="sc">/</span>libBLAS.dylib </span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>LAPACK<span class="sc">:</span> <span class="er">/</span>Library<span class="sc">/</span>Frameworks<span class="sc">/</span>R.framework<span class="sc">/</span>Versions<span class="sc">/</span><span class="fl">4.3</span><span class="sc">-</span>x86_64<span class="sc">/</span>Resources<span class="sc">/</span>lib<span class="sc">/</span>libRlapack.dylib;  LAPACK version <span class="dv">3</span>.<span class="fl">11.0</span></span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>locale<span class="sc">:</span></span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>[<span class="dv">1</span>] en_US.UTF<span class="dv">-8</span><span class="sc">/</span>en_US.UTF<span class="dv">-8</span><span class="sc">/</span>en_US.UTF<span class="dv">-8</span><span class="sc">/</span>C<span class="sc">/</span>en_US.UTF<span class="dv">-8</span><span class="sc">/</span>en_US.UTF<span class="dv">-8</span></span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a>time zone<span class="sc">:</span> America<span class="sc">/</span>New_York</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a>tzcode source<span class="sc">:</span> internal</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a></span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a>attached base packages<span class="sc">:</span></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>[<span class="dv">1</span>] stats4    stats     graphics  grDevices utils     datasets  methods   base     </span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a></span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a>other attached packages<span class="sc">:</span></span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a> [<span class="dv">1</span>] STexampleData_1.<span class="fl">10.0</span>        ExperimentHub_2.<span class="fl">10.0</span>        AnnotationHub_3.<span class="fl">10.0</span>       </span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a> [<span class="dv">4</span>] BiocFileCache_2.<span class="fl">10.1</span>        dbplyr_2.<span class="fl">4.0</span>                scran_1.<span class="fl">30.2</span>               </span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a> [<span class="dv">7</span>] scater_1.<span class="fl">30.1</span>               scuttle_1.<span class="fl">12.0</span>              pheatmap_1.<span class="fl">0.12</span>            </span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a>[<span class="dv">10</span>] ggspavis_1.<span class="fl">8.0</span>              ggplot2_3.<span class="fl">4.4</span>               SpatialExperiment_1.<span class="fl">12.0</span>   </span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a>[<span class="dv">13</span>] SingleCellExperiment_1.<span class="fl">24.0</span> SummarizedExperiment_1.<span class="fl">32.0</span> Biobase_2.<span class="fl">62.0</span>             </span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a>[<span class="dv">16</span>] GenomicRanges_1.<span class="fl">54.1</span>        GenomeInfoDb_1.<span class="fl">38.6</span>         IRanges_2.<span class="fl">36.0</span>             </span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a>[<span class="dv">19</span>] S4Vectors_0.<span class="fl">40.2</span>            BiocGenerics_0.<span class="fl">48.1</span>         MatrixGenerics_1.<span class="fl">14.0</span>      </span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a>[<span class="dv">22</span>] matrixStats_1.<span class="fl">2.0</span>           GiottoData_0.<span class="dv">2</span>.<span class="fl">7.0</span>          GiottoUtils_0.<span class="fl">1.5</span>          </span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a>[<span class="dv">25</span>] Giotto_4.<span class="fl">0.2</span>                GiottoClass_0.<span class="fl">1.3</span>          </span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" tabindex="-1"></a>loaded via a <span class="fu">namespace</span> (and not attached)<span class="sc">:</span></span>
<span id="cb33-30"><a href="#cb33-30" tabindex="-1"></a>  [<span class="dv">1</span>] RcppAnnoy_0.<span class="fl">0.22</span>              later_1.<span class="fl">3.2</span>                   bitops_1<span class="fl">.0</span><span class="dv">-7</span>                 </span>
<span id="cb33-31"><a href="#cb33-31" tabindex="-1"></a>  [<span class="dv">4</span>] filelock_1.<span class="fl">0.3</span>                tibble_3.<span class="fl">2.1</span>                  lifecycle_1.<span class="fl">0.4</span>              </span>
<span id="cb33-32"><a href="#cb33-32" tabindex="-1"></a>  [<span class="dv">7</span>] edgeR_4.<span class="fl">0.15</span>                  doParallel_1.<span class="fl">0.17</span>             globals_0.<span class="fl">16.2</span>               </span>
<span id="cb33-33"><a href="#cb33-33" tabindex="-1"></a> [<span class="dv">10</span>] lattice_0<span class="fl">.22</span><span class="dv">-5</span>                backports_1.<span class="fl">4.1</span>               magrittr_2.<span class="fl">0.3</span>               </span>
<span id="cb33-34"><a href="#cb33-34" tabindex="-1"></a> [<span class="dv">13</span>] limma_3.<span class="fl">58.1</span>                  rmarkdown_2<span class="fl">.25</span>                yaml_2.<span class="fl">3.8</span>                   </span>
<span id="cb33-35"><a href="#cb33-35" tabindex="-1"></a> [<span class="dv">16</span>] metapod_1.<span class="fl">10.1</span>                httpuv_1.<span class="fl">6.14</span>                 ggside_0.<span class="fl">2.3</span>                 </span>
<span id="cb33-36"><a href="#cb33-36" tabindex="-1"></a> [<span class="dv">19</span>] reticulate_1.<span class="fl">35.0</span>             cowplot_1.<span class="fl">1.3</span>                 DBI_1.<span class="fl">2.1</span>                    </span>
<span id="cb33-37"><a href="#cb33-37" tabindex="-1"></a> [<span class="dv">22</span>] RColorBrewer_1<span class="fl">.1</span><span class="dv">-3</span>            abind_1<span class="fl">.4</span><span class="dv">-5</span>                   zlibbioc_1.<span class="fl">48.0</span>              </span>
<span id="cb33-38"><a href="#cb33-38" tabindex="-1"></a> [<span class="dv">25</span>] purrr_1.<span class="fl">0.2</span>                   RCurl_1<span class="fl">.98-1.14</span>               rappdirs_0.<span class="fl">3.3</span>               </span>
<span id="cb33-39"><a href="#cb33-39" tabindex="-1"></a> [<span class="dv">28</span>] circlize_0.<span class="fl">4.15</span>               GenomeInfoDbData_1.<span class="fl">2.11</span>       ggrepel_0.<span class="fl">9.5</span>                </span>
<span id="cb33-40"><a href="#cb33-40" tabindex="-1"></a> [<span class="dv">31</span>] irlba_2.<span class="dv">3</span>.<span class="fl">5.1</span>                 listenv_0.<span class="fl">9.1</span>                 terra_1<span class="fl">.7</span><span class="dv">-71</span>                 </span>
<span id="cb33-41"><a href="#cb33-41" tabindex="-1"></a> [<span class="dv">34</span>] dqrng_0.<span class="fl">3.2</span>                   parallelly_1.<span class="fl">36.0</span>             DelayedMatrixStats_1.<span class="fl">24.0</span>    </span>
<span id="cb33-42"><a href="#cb33-42" tabindex="-1"></a> [<span class="dv">37</span>] colorRamp2_0.<span class="fl">1.0</span>              codetools_0<span class="fl">.2</span><span class="dv">-19</span>              DelayedArray_0.<span class="fl">28.0</span>          </span>
<span id="cb33-43"><a href="#cb33-43" tabindex="-1"></a> [<span class="dv">40</span>] shape_1.<span class="fl">4.6</span>                   tidyselect_1.<span class="fl">2.0</span>              farver_2.<span class="fl">1.1</span>                 </span>
<span id="cb33-44"><a href="#cb33-44" tabindex="-1"></a> [<span class="dv">43</span>] ScaledMatrix_1.<span class="fl">10.0</span>           viridis_0.<span class="fl">6.5</span>                 jsonlite_1.<span class="fl">8.8</span>               </span>
<span id="cb33-45"><a href="#cb33-45" tabindex="-1"></a> [<span class="dv">46</span>] GetoptLong_1.<span class="fl">0.5</span>              BiocNeighbors_1.<span class="fl">20.2</span>          ellipsis_0.<span class="fl">3.2</span>               </span>
<span id="cb33-46"><a href="#cb33-46" tabindex="-1"></a> [<span class="dv">49</span>] iterators_1.<span class="fl">0.14</span>              systemfonts_1.<span class="fl">0.5</span>             foreach_1.<span class="fl">5.2</span>                </span>
<span id="cb33-47"><a href="#cb33-47" tabindex="-1"></a> [<span class="dv">52</span>] dbscan_1<span class="fl">.1</span><span class="dv">-12</span>                 tools_4.<span class="fl">3.2</span>                   ragg_1.<span class="fl">2.7</span>                   </span>
<span id="cb33-48"><a href="#cb33-48" tabindex="-1"></a> [<span class="dv">55</span>] Rcpp_1.<span class="fl">0.12</span>                   glue_1.<span class="fl">7.0</span>                    gridExtra_2<span class="fl">.3</span>                </span>
<span id="cb33-49"><a href="#cb33-49" tabindex="-1"></a> [<span class="dv">58</span>] SparseArray_1.<span class="fl">2.4</span>             xfun_0<span class="fl">.42</span>                     dplyr_1.<span class="fl">1.4</span>                  </span>
<span id="cb33-50"><a href="#cb33-50" tabindex="-1"></a> [<span class="dv">61</span>] withr_3.<span class="fl">0.0</span>                   BiocManager_1.<span class="fl">30.22</span>           fastmap_1.<span class="fl">1.1</span>                </span>
<span id="cb33-51"><a href="#cb33-51" tabindex="-1"></a> [<span class="dv">64</span>] bluster_1.<span class="fl">12.0</span>                fansi_1.<span class="fl">0.6</span>                   digest_0.<span class="fl">6.34</span>                </span>
<span id="cb33-52"><a href="#cb33-52" tabindex="-1"></a> [<span class="dv">67</span>] rsvd_1.<span class="fl">0.5</span>                    R6_2.<span class="fl">5.1</span>                      mime_0<span class="fl">.12</span>                    </span>
<span id="cb33-53"><a href="#cb33-53" tabindex="-1"></a> [<span class="dv">70</span>] textshaping_0.<span class="fl">3.7</span>             colorspace_2<span class="fl">.1</span><span class="dv">-0</span>              Cairo_1<span class="fl">.6</span><span class="dv">-2</span>                  </span>
<span id="cb33-54"><a href="#cb33-54" tabindex="-1"></a> [<span class="dv">73</span>] gtools_3.<span class="fl">9.5</span>                  RSQLite_2.<span class="fl">3.5</span>                 utf8_1.<span class="fl">2.4</span>                   </span>
<span id="cb33-55"><a href="#cb33-55" tabindex="-1"></a> [<span class="dv">76</span>] generics_0.<span class="fl">1.3</span>                data.table_1.<span class="fl">15.0</span>             FNN_1.<span class="fl">1.4</span>                    </span>
<span id="cb33-56"><a href="#cb33-56" tabindex="-1"></a> [<span class="dv">79</span>] httr_1.<span class="fl">4.7</span>                    S4Arrays_1.<span class="fl">2.0</span>                uwot_0.<span class="fl">1.16</span>                  </span>
<span id="cb33-57"><a href="#cb33-57" tabindex="-1"></a> [<span class="dv">82</span>] pkgconfig_2.<span class="fl">0.3</span>               gtable_0.<span class="fl">3.4</span>                  blob_1.<span class="fl">2.4</span>                   </span>
<span id="cb33-58"><a href="#cb33-58" tabindex="-1"></a> [<span class="dv">85</span>] ComplexHeatmap_2.<span class="fl">18.0</span>         GiottoVisuals_0.<span class="fl">1.4</span>           XVector_0.<span class="fl">42.0</span>               </span>
<span id="cb33-59"><a href="#cb33-59" tabindex="-1"></a> [<span class="dv">88</span>] htmltools_0.<span class="fl">5.7</span>               clue_0<span class="fl">.3</span><span class="dv">-65</span>                   scales_1.<span class="fl">3.0</span>                 </span>
<span id="cb33-60"><a href="#cb33-60" tabindex="-1"></a> [<span class="dv">91</span>] png_0<span class="fl">.1</span><span class="dv">-8</span>                     knitr_1<span class="fl">.45</span>                    rstudioapi_0.<span class="fl">15.0</span>            </span>
<span id="cb33-61"><a href="#cb33-61" tabindex="-1"></a> [<span class="dv">94</span>] rjson_0.<span class="fl">2.21</span>                  checkmate_2.<span class="fl">3.1</span>               curl_5.<span class="fl">2.0</span>                   </span>
<span id="cb33-62"><a href="#cb33-62" tabindex="-1"></a> [<span class="dv">97</span>] GlobalOptions_0.<span class="fl">1.2</span>           cachem_1.<span class="fl">0.8</span>                  BiocVersion_3.<span class="fl">18.1</span>           </span>
<span id="cb33-63"><a href="#cb33-63" tabindex="-1"></a>[<span class="dv">100</span>] parallel_4.<span class="fl">3.2</span>                vipor_0.<span class="fl">4.7</span>                   AnnotationDbi_1.<span class="fl">64.1</span>         </span>
<span id="cb33-64"><a href="#cb33-64" tabindex="-1"></a>[<span class="dv">103</span>] pillar_1.<span class="fl">9.0</span>                  grid_4.<span class="fl">3.2</span>                    vctrs_0.<span class="fl">6.5</span>                  </span>
<span id="cb33-65"><a href="#cb33-65" tabindex="-1"></a>[<span class="dv">106</span>] promises_1.<span class="fl">2.1</span>                BiocSingular_1.<span class="fl">18.0</span>           beachmat_2.<span class="fl">18.0</span>              </span>
<span id="cb33-66"><a href="#cb33-66" tabindex="-1"></a>[<span class="dv">109</span>] xtable_1<span class="fl">.8</span><span class="dv">-4</span>                  cluster_2.<span class="fl">1.6</span>                 beeswarm_0.<span class="fl">4.0</span>               </span>
<span id="cb33-67"><a href="#cb33-67" tabindex="-1"></a>[<span class="dv">112</span>] evaluate_0<span class="fl">.23</span>                 magick_2.<span class="fl">8.2</span>                  cli_3.<span class="fl">6.2</span>                    </span>
<span id="cb33-68"><a href="#cb33-68" tabindex="-1"></a>[<span class="dv">115</span>] locfit_1<span class="fl">.5-9.8</span>                compiler_4.<span class="fl">3.2</span>                rlang_1.<span class="fl">1.3</span>                  </span>
<span id="cb33-69"><a href="#cb33-69" tabindex="-1"></a>[<span class="dv">118</span>] crayon_1.<span class="fl">5.2</span>                  future.apply_1.<span class="fl">11.1</span>           labeling_0.<span class="fl">4.3</span>               </span>
<span id="cb33-70"><a href="#cb33-70" tabindex="-1"></a>[<span class="dv">121</span>] ggbeeswarm_0.<span class="fl">7.2</span>              viridisLite_0.<span class="fl">4.2</span>             deldir_2<span class="fl">.0</span><span class="dv">-2</span>                 </span>
<span id="cb33-71"><a href="#cb33-71" tabindex="-1"></a>[<span class="dv">124</span>] BiocParallel_1.<span class="fl">36.0</span>           munsell_0.<span class="fl">5.0</span>                 Biostrings_2.<span class="fl">70.2</span>            </span>
<span id="cb33-72"><a href="#cb33-72" tabindex="-1"></a>[<span class="dv">127</span>] Matrix_1<span class="fl">.6</span><span class="dv">-5</span>                  sparseMatrixStats_1.<span class="fl">14.0</span>      bit64_4.<span class="fl">0.5</span>                  </span>
<span id="cb33-73"><a href="#cb33-73" tabindex="-1"></a>[<span class="dv">130</span>] future_1.<span class="fl">33.1</span>                 KEGGREST_1.<span class="fl">42.0</span>               statmod_1.<span class="fl">5.0</span>                </span>
<span id="cb33-74"><a href="#cb33-74" tabindex="-1"></a>[<span class="dv">133</span>] shiny_1.<span class="fl">8.0</span>                   interactiveDisplayBase_1.<span class="fl">40.0</span> igraph_2.<span class="dv">0</span>.<span class="fl">1.1</span>               </span>
<span id="cb33-75"><a href="#cb33-75" tabindex="-1"></a>[<span class="dv">136</span>] memoise_2.<span class="fl">0.1</span>                 bit_4.<span class="fl">0.5</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://www.drieslab.com" class="external-link">Ruben Dries</a>, Jiaji George Chen, <a href="https://josschavezf.github.io" class="external-link">Joselyn C. Chávez-Fuentes</a>, <a href="https://labs.icahn.mssm.edu/yuanlab/" class="external-link">Guo-Cheng Yuan</a>, Matthew O’Brien, Edward Ruiz, Wen Wang, Natalie Del Rossi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
